<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Provas Bíblicas</title>

<style>
body {
  font-family: Arial, sans-serif;
  margin: 0;
  padding-top: 60px;
  background: #f4f6f9;
}

h2 { text-align: center; margin: 20px 0; }

/* MENU SUPERIOR FIXO */
#topbar {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 60px;
  background: #2c7be5;
  color: #fff;
  display: flex;
  align-items: center;
  padding: 0 20px;
  z-index: 10000;
}

.menu-item {
  margin-right: 30px;
  font-weight: bold;
  cursor: pointer;
  position: relative;
}

.menu-item:hover { text-decoration: underline; }

/* DROPDOWN */
.dropdown-content {
  display: none;
  position: absolute;
  top: 100%;
  left: 0;
  background: #fff;
  min-width: 250px; /* aumenta para acomodar respostas longas */
  box-shadow: 0 4px 10px rgba(0,0,0,0.15);
  border-radius: 6px;
  overflow: hidden;
  z-index: 10001;
}

.dropdown-content div {
  padding: 12px;
  color: #333;
  cursor: pointer;
}

.dropdown-content div:hover { background: #f0f0f0; }

.menu-item.dropdown:hover .dropdown-content { display: block; }

/* MENU PRINCIPAL */
#inicio {
  position: fixed;
  top: 60px;
  left: 0;
  width: 100%;
  height: calc(100% - 60px);
  background:#f4f6f9;
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:9999;
}

.menu-box {
  width: 100%;
  max-width: 900px;
  background: #fff;
  padding: 25px;
  border-radius: 14px;
}

.menu-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr); /* 4 cards lado a lado */
  gap: 15px;
}

.menu-card {
  border: 2px solid #2c7be5;
  border-radius: 12px;
  padding: 20px;
  text-align: center;
}

.menu-card h3 { margin: 10px 0 5px; }
.menu-card p { margin-bottom: 15px; font-size: 14px; }

button {
  padding: 14px;
  font-size: 16px;
  width: 100%;
  background: #2c7be5;
  color: white;
  border: none;
  border-radius: 6px;
  cursor: pointer;
}

/* TELA DE IDENTIFICAÇÃO */
#tela-identificacao {
  position: fixed;
  top: 60px;
  left: 0;
  width: 100%;
  height: calc(100% - 60px);
  background:#f4f6f9;
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:9999;
  flex-direction: column;
  display: none;
}

#tela-identificacao .id-box {
  background:#fff;
  padding:25px;
  border-radius:14px;
  text-align:center;
  width:90%;
  max-width:500px; /* aumenta para respostas longas */
}

#tela-identificacao input {
  width: 90%;
  padding:10px;
  margin: 15px 0;
  font-size:16px;
  border-radius:6px;
  border: 1px solid #ccc;
}

/* PROVA */
#prova-container {
  display: flex;
  justify-content: center;
  gap: 20px;
  margin: 20px;
  display: none;
  flex-wrap: wrap;
}

.column {
  display: flex;
  flex-direction: column;
  gap: 10px;
  width: 100%;
  max-width: 500px; /* aumenta para respostas longas */
}

.question {
  display: none;
  padding: 12px;
  border-radius: 8px;
  background: #fff;
  border: 2px solid #2c7be5;
  word-wrap: break-word;
}

.question.active { display: block; }

#finalizar-btn {
  display: none;
  margin: 20px auto;
  width: 200px;
}

/* RESULTADO */
#resultado {
  position: fixed;
  top:0; left:0;
  width:100%;
  height:100%;
  background: rgba(0,0,0,0.6);
  display: none;
  align-items:center;
  justify-content:center;
  z-index:10002;
}

.result-box {
  background:#fff;
  padding:25px;
  width:90%;
  max-width:450px;
  border-radius:14px;
  text-align:center;
}

.pontos {
  font-size: 44px;
  font-weight: bold;
  color: #2c7be5;
  margin: 10px 0;
}

.result-text {
  font-size: 16px;
  margin: 8px 0;
}
.result-btn {
  margin: 10px;
  padding: 10px 20px;
  width: 80%;
  font-size: 16px;
  border: none;
  border-radius: 6px;
  background: #2c7be5;
  color: white;
  cursor: pointer;
}

/* RESULTADOS VISUALIZAÇÃO */
#tela-resultados {
  position: fixed;
  top:0; left:0;
  width:100%;
  height:100%;
  background: rgba(0,0,0,0.6);
  display: none;
  align-items:center;
  justify-content:center;
  z-index:10003;
}
#tela-resultados .result-box {
  max-width:700px;
  overflow-y:auto;
  max-height: 80%;
  text-align:left;
}
#tela-resultados .result-box h3 {
  text-align:center;
}
#tela-resultados .result-box div {
  margin-bottom:10px;
}
</style>
</head>

<body>

<!-- MENU SUPERIOR FIXO -->
<div id="topbar">
  <div class="menu-item" onclick="mostrarMenu()">Menu Inicial</div>

  <div class="menu-item dropdown">
    Provas ▼
    <div class="dropdown-content">
      <div onclick="mostrarIdentificacao(1)">Prova 1 – Criação</div>
      <div onclick="mostrarIdentificacao(2)">Prova 2 – Jardim do Éden</div>
      <div onclick="mostrarIdentificacao(3)">Prova 3 – O Pecado</div>
      <div onclick="mostrarIdentificacao(4)">Prova 4 – Filhos de Adão e Eva</div>
      <div onclick="mostrarIdentificacao(5)">Prova 5 – Guerra no Céu</div>
    </div>
  </div>

  <div class="menu-item dropdown">
    Resultados ▼
    <div class="dropdown-content" id="menu-resultados">
      <div>Nenhum resultado disponível</div>
    </div>
  </div>
</div>

<!-- MENU PRINCIPAL -->
<div id="inicio">
  <div class="menu-box">
    <div class="menu-grid">

      <div class="menu-card">
        <h3>Prova 1</h3>
        <p>A Criação</p>
        <button onclick="mostrarIdentificacao(1)">INICIAR</button>
      </div>
      
      <div class="menu-card">
        <h3>Prova 2</h3>
        <p>O Jardim do Éden</p>
        <button onclick="mostrarIdentificacao(2)">INICIAR</button>
      </div>
      
      <div class="menu-card">
        <h3>Prova 3</h3>
        <p>O Pecado</p>
        <button onclick="mostrarIdentificacao(3)">INICIAR</button>
      </div>
      
      <div class="menu-card">
        <h3>Prova 4</h3>
        <p>Os filhos de Adão e Eva</p>
        <button onclick="mostrarIdentificacao(4)">INICIAR</button>
      </div>

      <div class="menu-card">
        <h3>Prova 5 </h3>
        <p>Guerra no Céu</p>
        <button onclick="mostrarIdentificacao(5)">INICIAR</button>
      </div>

    </div>
  </div>
</div>

<!-- TELA DE IDENTIFICAÇÃO -->
<div id="tela-identificacao">
  <div class="id-box">
    <h3 id="id-titulo">Prova</h3>
    <p>Antes de começar, digite seu nome:</p>
    <input type="text" id="nome-participante" placeholder="Nome do participante">
    <button onclick="iniciarProva()">INICIAR PROVA</button>
  </div>
</div>

<!-- PROVA -->
<div id="prova-container">
  <div class="column" id="col-left"></div>
  <div class="column" id="col-right"></div>
</div>

<button id="finalizar-btn" onclick="finalizarProva()">Finalizar Prova</button>

<!-- RESULTADO -->
<div id="resultado">
  <div class="result-box">
    <h3 id="res-title">Resultado</h3>
    <div class="result-text" id="res-participante">Participante: </div>
    <div class="pontos" id="res-nota">0 / 10</div>
    <div class="result-text" id="res-tempo">Tempo: 0 segundos</div>
    <div class="result-text" id="res-status">Status: REPROVADO</div>
    <div class="result-text" id="res-msg">Você não atingiu a nota mínima.</div>
    <button class="result-btn" onclick="refazerProva()">REFAZER ESTA PROVA</button><br>
    <button class="result-btn" onclick="mostrarMenu()">VOLTAR AO MENU PRINCIPAL</button>
  </div>
</div>

<!-- TELA RESULTADOS -->
<div id="tela-resultados">
  <div class="result-box">
    <h3>Resultados das Provas</h3>
    <div id="lista-resultados"></div>
    <button class="result-btn" onclick="fecharResultados()">VOLTAR AO MENU PRINCIPAL</button>
  </div>
</div>

<script>
let inicioTempo;
let atualProva = 1;
let nomeParticipante = "";
let resultados = {};

/* GOOGLE SHEETS (API) */
const GOOGLE_SHEETS_URL = "https://script.google.com/macros/s/AKfycbzrpoWwF4tLvbLtiFtP5LKSRiZ5AUIJyRMti01XRj9GilqEEUwKsYO3ZpX2gH_-tCeBAA/exec";

const provas = {
1: [ // Prova 1 – A Criação
    ["Quem é Deus?", ["Uma força","Um poder","Um espírito","Todas as alternativas"],3],
    ["Quais as 3 manifestações de Deus?", ["Deus","Jesus","Espírito Santo","Todas as alternativas"],3],
    ["Como Deus criou o planeta Terra?", ["Passe de mágica","Soprou","Pela sua palavra","Chamou Adão"],2],
    ["Quantos dias Deus criou?", ["6 dias","8 dias","7 dias","5 dias"],2],
    ["Como a Terra estava antes da criação?", ["Escura","Sem forma","Vazia","Todas as alternativas"],3],
    ["O que Deus criou no sexto dia?", ["Lua e sol","Águas e terra","Plantas","O homem e a mulher"],3],
    ["O que Deus fez no sétimo dia?", ["Abençoou e santificou","Descansou, abençoou e santificou","Somente descansou","Nada"],1],
    ["Primeiro homem criado por Deus?", ["Jesus","Éden","Adão","Abel"],2],
    ["Primeira mulher?", ["Erva","Eva","Evra","Evã"],1],
    ["Presente dado por Deus?", ["Animais","Cordeiro","Jardim do Éden","Árvore da vida"],2]
  ],
2: [ // Prova 2 – O Jardim do Éden
    ["Com quais animais Adão e Eva conversavam no jardim?", ["Com o leão","Com os pássaros","Com a serpente","Nenhuma das alternativas pois eles não falavam"],3],
    ["Qual a função de Adão e Eva com o jardim?", ["Avisar Deus se uma árvore cair","Fazer casas","Cuidar","Todas as alternativas"],2],
    ["Qual aviso Deus deu para Adão e Eva?", ["Não coma nenhum fruto de nenhuma árvore","Coma do fruto da árvore do conhecimento do bem e do mal","Ensine os animais a falarem","Nenhuma das alternativas"],3],
    ["O que aconteceu com Eva e a serpente?", ["Eles estavam conversando","Eva deu um fruto para a serpente","A serpente deu um fruto para Eva","Eva chamou Adão para expulsar a serpente"],0],
    ["Quem comeu o fruto que não poderia comer?", ["Eva e a serpente","Eva, Adão e a serpente","Eva, Adão e o Cordeiro","Nenhuma das alternativas"],3],
    ["Qual foi a frase de Deus para Adão e Eva?", ["Coma todos os frutos das árvores do jardim livremente","Coma somente o fruto da árvore da vida","Não coma o fruto da árvore do entendimento do bem e do mal","Não coma o fruto da árvore do conhecimento do bem e do mal"],3],
    ["O que aconteceria se comer da árvore do conhecimento do bem e do mal?", ["Certamente a serpente morreria","Certamente a árvore cairia","Certamente morrerás","Certamente vai sair do jardim do Éden"],2],
    ["Qual foi a intenção da serpente?", ["Mentir","Mudar a ordem de Deus","Enganar","Todas as alternativas"],3],
    ["Depois que Adão e Eva comeram o fruto, o que aconteceu?", ["Eva e Adão foram chamar Deus","Eva se retirou e a serpente saiu voando","Adão achou Eva caída no jardim","Nenhuma das alternativas"],3],
    ["Quando Deus chamou Adão e Eva, onde eles estavam?", ["Escondido em cima da maior árvore","Escondidos atrás da árvore do conhecimento do bem e do mal","Escondidos","Escondidos perto do rio"],2]
  ],
3: [ // Prova 3 – O Pecado
  ["Quem foi o animal usado por Satanas para falar com a mulher?", ["Um leão","Um macaco","Uma serpente","Um pássaro"],2],
  ["Qual foi a primeira pergunta feita pela serpente à mulher?", ["Deus criou todas as coisas?","Foi assim que Deus disse: Não comereis de toda árvore do jardim?","Onde está Adão?","Por que vocês estão no jardim?"],1],
  ["O que a serpente disse que aconteceria se o fruto fosse comido?", ["Eles morreriam imediatamente","Eles se tornariam anjos","Seus olhos se abririam e seriam como Deus","O jardim desapareceria"],2],
  ["Após comerem do fruto, o que aconteceu primeiro com Adão e Eva?", ["Foram expulsos do jardim","Seus olhos se abriram","Deus apareceu imediatamente","Eles dormiram"],1],
  ["O que Adão e Eva fizeram ao perceberem que estavam nus?", ["Costuraram folhas de figueira","Usaram peles de animais","Pediram roupas a Deus","Fugiram do jardim"],0],
  ["Onde Adão e Eva se esconderam quando ouviram a voz de Deus?", ["Atrás das árvores do jardim","Fora do jardim","Dentro do rio","Em uma caverna"],0],
  ["Qual foi a justificativa de Adão para ter comido do fruto?", ["A serpente o enganou","Ele estava com fome","A mulher que Deus lhe deu lhe ofereceu","Ele não sabia da ordem de Deus"],2],
  ["Quem Eva culpou por ter comido do fruto?", ["Adão","Deus","A serpente","Ela mesma"],2],
  ["Qual foi a maldição dada à serpente?", ["Ser lançada no fogo","Perder a fala","Andar sobre o ventre e comer pó","Ser expulsa do jardim"],2],
  ["O que Deus colocou no jardim após expulsar o homem?", ["Um muro de fogo","Um anjo com espada flamejante","Um dilúvio","Uma nuvem escura"],1]
],
4: [ // Prova 4 – Filhos de Adão e Eva
  ["Quem foram os dois primeiros filhos de Adão e Eva mencionados em Gênesis 4?", ["Cain e Abel","Caim e Abel","Kaim e Abeu","Caim e Habel"],1],
  ["Qual era a ocupação de Caim?", ["Pastor de ovelhas","Caçador","Lavrador da terra","Construtor"],2],
  ["Qual era a ocupação de Abel?", ["Lavrador","Pastor de ovelhas","Pescador","Comerciante"],1],
  ["Qual oferta Deus aceitou?", ["A de Caim","A de Abel","As duas ofertas","Nenhuma das ofertas"],1],
  ["Como Caim reagiu quando Deus não aceitou sua oferta?", ["Alegrou-se","Ignorou","Ficou muito irado","Pediu perdão"],2],
  ["O que Deus disse que o pecado estava fazendo?", ["Estava sendo perdoado","Estava adormecido","Estava à porta, desejando dominá-lo","Estava distante do homem"],2],
  ["O que Caim fez com Abel?", ["Planejou e matou ele","Encontrou ele morto no jardim","Encontrou ele morto no campo","Sem querer matou ele"],0],
  ["Onde Caim matou Abel?", ["Na cidade","No templo","No campo","No jardim"],2],
  ["Qual foi a resposta de Caim quando Deus perguntou por Abel?", ["Ele está no campo","Não sei; sou eu guardador do meu irmão?","Ele fugiu","Ele morreu"],1],
  ["Qual foi a consequência direta imposta a Caim após o assassinato?", ["Morte imediata","Prisão","Tornar-se fugitivo e errante","Expulsão do Éden"],2]
],
5: [ // Prova 5 – Guerra no Céu
  ["Como é descrito o anjo que iniciou guerra no Céu?", ["Anjo mensageiro","Querubim","Arcanjo","Gabriel"],1],
  ["Qual foi o desejo expresso pelo ser querubim?", ["Servir aos homens","Habitar acima dos anjos","Guardar o trono de Deus","Exaltar-se acima das estrelas de Deus"],3],
  ["Esse querubim é identificado como?", ["Um animal simbólico","Um querubim fiel","Dragão, a antiga serpente, chamada Diabo e Satanás","Um anjo de Miguel"],2],
  ["O querubim desejou ser?", ["Poderoso mais que Deus","Ter mais autoridade que Deus","Tomar o trono de Deus","Todas as alternativas"],3],
  ["Quem lutou contra o dragão e seus anjos no céu?", ["Miguel e seus anjos","Gabriel e seus anjos","Os vinte e quatro anciãos","Os querubins do Éden"],0],
  ["Qual foi o resultado da peleja no céu?", ["O dragão venceu","O dragão perdeu o seu lugar no céu","Houve empate","O céu foi destruído"],1],
  ["Para onde o dragão e seus anjos foram lançados após a derrota?", ["Para o lago de fogo","Para o abismo imediatamente","Para a terra","Para o deserto do Sinai"],2],
  ["O que aconteceu com o dragão após ser lançado à terra?", ["Passou a perseguir os habitantes da terra","Perdeu todo o poder","Foi destruído imediatamente","Voltou ao céu"],0],
  ["Por que o diabo desce à terra com grande ira?", ["Porque perdeu seus anjos","Porque foi expulso do Éden","Porque sabe que tem pouco tempo","Porque perdeu seu poder"],2],
  ["Qual verdade espiritual a peleja no céu revela?", ["Os anjos são iguais aos homens","Deus perdeu o controle por um tempo","O céu pode ser destruído","O mal não prevalece contra o propósito de Deus"],3]
]
};

// ------------------ FUNÇÕES ------------------

function mostrarIdentificacao(prova){
  atualProva = prova;
  document.getElementById("inicio").style.display = "none";
  document.getElementById("tela-identificacao").style.display = "flex";

  // Mapeamento completo das provas
  let titulo = "";
  switch(prova){
    case 1: titulo = "A Criação"; break;
    case 2: titulo = "O Jardim do Éden"; break;
    case 3: titulo = "O Pecado"; break;
    case 4: titulo = "Os filhos de Adão e Eva"; break;
    case 5: titulo = "Guerra no Céu"; break;
    default: titulo = "Prova"; break;
  }

  document.getElementById("id-titulo").innerText = `Prova ${prova} – ${titulo}`;
}

function iniciarProva(){
  const nome = document.getElementById("nome-participante").value.trim();
  if(nome===""){ alert("Digite seu nome antes de iniciar a prova."); return; }
  nomeParticipante = nome;
  document.getElementById("tela-identificacao").style.display = "none";
  document.getElementById("prova-container").style.display = "flex";
  inicioTempo = Date.now();
  gerarProva();
}

function gerarProva(){
  const colLeft = document.getElementById("col-left");
  const colRight = document.getElementById("col-right");
  colLeft.innerHTML=""; colRight.innerHTML="";
  const provaAtual = provas[atualProva];
  provaAtual.forEach((p,i)=>{
    const div = document.createElement("div");
    div.className="question";
    div.id="q"+(i+1);
    div.innerHTML = `<b>${i+1}. ${p[0]}</b><br>`;
    p[1].forEach((alt,j)=>{
      div.innerHTML += `<label><input type="radio" name="q${i+1}" value="${j===p[2]?1:0}"> ${alt}</label><br>`;
    });
    if(i<Math.ceil(provaAtual.length/2)) colLeft.appendChild(div);
    else colRight.appendChild(div);
    div.querySelectorAll("input").forEach(input=>{
      input.addEventListener("change", ()=>{
        div.classList.add("active");
        if(i<provaAtual.length-1){
          document.getElementById("q"+(i+2)).classList.add("active");
        } else {
          document.getElementById("finalizar-btn").style.display="block";
        }
      });
    });
  });
  document.getElementById("q1").classList.add("active");
  document.getElementById("finalizar-btn").style.display="none";
}

function finalizarProva(){
  let nota = 0;
  let respostas = {};
  const provaAtual = provas[atualProva];

  for(let i=1;i<=provaAtual.length;i++){
    const q = document.getElementsByName("q"+i);
    q.forEach((input,index)=>{
      if(input.checked){ 
        nota += parseInt(input.value); 
        respostas["q"+i] = input.value; 
        respostas["q"+i+"-index"] = index;
      }
    });
    if(!respostas["q"+i]) respostas["q"+i] = "";
  }

  const tempo = Math.floor((Date.now() - inicioTempo) / 1000);
  const dataAtual = new Date().toLocaleString();

  if(!resultados[`Prova ${atualProva}`]) {
    resultados[`Prova ${atualProva}`] = {};
  }

  resultados[`Prova ${atualProva}`][nomeParticipante] = {
    respostas,
    nota,
    tempo,
    data: dataAtual
  };

  /* ===== ENVIO PARA GOOGLE SHEETS ===== */
  const payload = {
    data: dataAtual,
    prova: `Prova ${atualProva}`,
    participante: nomeParticipante,
    nota: nota,
    tempo: tempo,
    respostas: respostas
  };

  enviarParaGoogleSheets(payload);
  /* =================================== */

  atualizarMenuResultados();
  mostrarResultadoIndividual(`Prova ${atualProva}`, nomeParticipante);
}

function enviarParaGoogleSheets(dados) {
  fetch(GOOGLE_SHEETS_URL, {
    method: "POST",
    body: JSON.stringify(dados)
  })
  .then(res => res.json())
  .then(ret => {
    if (ret.status !== "ok") {
      console.warn("Google Sheets respondeu, mas não confirmou OK:", ret);
    }
  })
  .catch(err => {
    console.error("Erro ao enviar dados para Google Sheets:", err);
  });
}

function atualizarMenuResultados() {
  const menu = document.getElementById("menu-resultados");
  menu.innerHTML="";
  if(Object.keys(resultados).length===0){
    menu.innerHTML="<div>Nenhum resultado disponível</div>";
    return;
  }
  for(let prova in resultados){
    for(let participante in resultados[prova]){
      const div=document.createElement("div");
      div.innerText=`${prova} – ${participante}`;
      div.style.cursor="pointer";
      div.onclick=()=> mostrarResultadoCompleto(prova, participante);
      menu.appendChild(div);
    }
  }
}

function mostrarResultadoIndividual(prova, participante){
  const dados = resultados[prova][participante];
  const status = dados.nota>=7?"APROVADO":"REPROVADO";
  document.getElementById("res-title").innerText=`Resultado — ${prova}`;
  document.getElementById("res-participante").innerText=`Participante: ${participante}`;
  document.getElementById("res-nota").innerText = dados.nota;  // somente número de acertos
  document.getElementById("res-tempo").innerText=`Tempo: ${dados.tempo} segundos`;
  document.getElementById("res-status").innerText=`Status: ${status}`;
  document.getElementById("res-msg").innerText=status==="APROVADO"?"Parabéns! Você foi aprovado.":"Você não atingiu a nota mínima.";
  document.getElementById("resultado").style.display="flex";
}

function mostrarResultadoCompleto(prova, participante){
  const dados = resultados[prova][participante];
  const provaAtual = provas[parseInt(prova.split(" ")[1])]; // pega as questões
  const listaResultados = document.getElementById("lista-resultados");
  listaResultados.innerHTML = `<h3>${prova} – ${participante}</h3>`;
  
  provaAtual.forEach((questao, i)=>{
    const numero = i+1;
    const div = document.createElement("div");
    div.style.border = "2px solid #2c7be5"; // borda azul
    div.style.borderRadius = "8px";
    div.style.padding = "12px";
    div.style.marginBottom = "12px";

    let alternativasHTML = "";
    const respostaUsuario = dados.respostas["q"+numero];
    const indiceCorreto = questao[2];
    const acertou = respostaUsuario == 1; // se marcou correta

    questao[1].forEach((alt, j)=>{
      const valorCorreto = (j === indiceCorreto);
      // Apenas seleciona o radio se for a resposta do usuário
      const marcado = (!acertou && respostaUsuario == 0 && j === parseInt(dados.respostas["q"+numero+"-index"])) 
                       || (acertou && valorCorreto);

      alternativasHTML += `
        <label style="display:block; padding:6px; border-radius:4px;">
          <input type="radio" disabled ${marcado ? "checked" : ""}> ${alt}
        </label>
      `;
    });

    // Define fundo do bloco
    div.style.backgroundColor = acertou ? "#d4edda" : "#f8d7da";

    // Linha extra
   div.innerHTML = `<b>${numero}. ${questao[0]}</b><br>${alternativasHTML}`;
    if(!acertou){
      div.innerHTML += `<br><b>Resposta correta: ${String.fromCharCode(65 + indiceCorreto)}</b>`;
    }

    listaResultados.appendChild(div);
  });

  document.getElementById("tela-resultados").style.display="flex";
}


function refazerProva(){
  document.getElementById("resultado").style.display="none";
  document.getElementById("nome-participante").value="";
  iniciarProva();
}

function mostrarMenu(){
  document.getElementById("inicio").style.display="flex";
  document.getElementById("tela-identificacao").style.display="none";
  document.getElementById("prova-container").style.display="none";
  document.getElementById("resultado").style.display="none";
}

function fecharResultados(){
  document.getElementById("tela-resultados").style.display="none";
  mostrarMenu();
}

/* PEGA DADOS DA PLANILHA RESULTADOS DO GOOGLE SHEETS E MOSTRA NO HTML */
function carregarResultadosDoSheets() {
  fetch(GOOGLE_SHEETS_URL)
    .then(res => res.json())
    .then(dados => {
      resultados = {};

      dados.forEach(item => {
        if (!resultados[item.prova]) {
          resultados[item.prova] = {};
        }

        resultados[item.prova][item.participante] = {
          nota: item.nota,
          tempo: item.tempo,
          data: item.data,
          respostas: JSON.parse(item.respostas || "{}")
        };
      });

      atualizarMenuResultados();
    })
    .catch(err => {
      console.error("Erro ao carregar resultados do Sheets:", err);
    });
}

window.onload = function() {
  carregarResultadosDoSheets();
};

// Atalho ESC para voltar ao menu principal
  document.addEventListener("keydown", function(event) {
    if (event.key === "Escape") {
      mostrarMenu();
    }
  });

</script>

</body>
</html>
